# How to run

## 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ ffplay / VLC

–≠—Ç–æ –Ω—É–∂–Ω–æ —á—Ç–æ–±—ã —Å–º–æ—Ç—Ä–µ—Ç—å —Ç—Ä–∞–Ω—Å–∏–ª—è—Ü–∏—é —Å RTSP –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö

## üõ† –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

–ü—Ä–æ–µ–∫—Ç (backend —á–∞—Å—Ç—å –ø—Ä–æ–µ–∫—Ç–∞) –Ω–∞–ø–∏—Å–∞–Ω –Ω–∞ **Python**, –ø–æ—ç—Ç–æ–º—É:

> ‚ö†Ô∏è **–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Python —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ –≤–∞—à–µ–π —Å–∏—Å—Ç–µ–º–µ.**  
> –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –≤–µ—Ä—Å–∏—è: **Python 3.9+**

–ï—Å–ª–∏ Python –µ—â—ë –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω ‚Äî —Å–∫–∞—á–∞–π—Ç–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –µ–≥–æ —Å [–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Å–∞–π—Ç–∞](https://www.python.org/downloads/).
–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ Python –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –∫–æ—Ä–µ–Ω—å –ø—Ä–æ–µ–∫—Ç–∞ –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```bash
pip install -r requirements.txt
```
–≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ backend-—á–∞—Å—Ç–∏.

## 3. –ó–∞–ø—É—Å–∫ FastApi (main.py) –¥–ª—è –≥–µ–Ω–µ—Ä–∏–∞—Ü–∏–∏ RTMP –ø–æ—Ç–æ–∫–∞ –∏–∑ –≤–∏–¥–µ–æ

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å —Ä–∞–±–æ—á–∏–π RTMP –ø–æ—Ç–æ–∫, —Ç–æ –ø—Ä–æ–ø—É—Å–∫–∞–π—Ç–µ —ç—Ç–æ—Ç –ø—É–Ω–∫—Ç, –∞ –µ—Å–ª–∏ –∂–µ —É –≤–∞—Å –Ω–µ—Ç—É RTMP –ø–æ—Ç–æ–∫–∞ –¥–ª—è —Ç–µ—Å—Ç–∞ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ API (RTMP -> RTSP –∫–æ–Ω–≤–µ—Ä–µ—Ä) —Ç–æ –≤—ã –º–æ–∂–µ—Ç–µ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —ç—Ç–∏–º —Å–µ—Ä–≤–∏—Å–æ–º
–ó–∞–ø—É—Å–∫:

–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é \backend
–∏ –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É uvicorn main:app --host 0.0.0.0 --port 8000
```bash
cd bachend
python -m uvicorn main:app --host 0.0.0.0 --port 8000
```

–ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å RTMP –ø–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö —Å –≤–∏–¥–µ–æ (–∑–∞—Ä–∞–Ω–µ–µ —Å–∫–∞—á–µ–Ω–Ω—ã–π) –≤—ã –¥–æ–ª–∂–Ω—ã –æ—Ç–ø—Ä–∞–≤–∏—Ç—å POST –∑–∞–ø—Ä–æ—Å:

POST http://localhost:8000/stream/start

Request Body:

```json
{
  "video_path": "–ø—É—Ç—å_–∫_–≤–∏–¥–µ–æ", // –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–µ –∑–∞–±—ã–≤–∞–π—Ç–µ —ç–∫—Ä–∞–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å \
  "stream_key": "–Ω–∞–∑–≤–∞–Ω–∏–µ_—Å—Ç—Ä–∏–º" 
}
```

## 4. –ó–∞–ø—É—Å–∫ RTMP -> RTSP –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä–∞ (–æ–ø–∏—Å–∞–Ω–Ω—ã–π –≤ –¢–ó)

–ü–æ –¢–ó, —ç—Ç–æ –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–Ω–∏–º–∞–µ—Ç RTMP

(–ù–∞ –ø—É—Ç–∏ /backend)
```bash
pytonh -m uvicorn main:app --reload --host 0.0.0.0 --port 8000
```
–û—Å–Ω–æ–≤–Ω–æ–π API Endpoint –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è RTSP –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å RTMP:

POST http://localhost:8001/stream/convert

Request Body:
```json
{
  "rtmp_source": "<—Å—Å—ã–ª–∫–∞ –Ω–∞ rtmp –ø–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö>" // –ø—Ä–∏–º–µ—Ä: rtmp://localhost:1935/live/sample1
}
```

–ù–∞ —á—Ç–æ –≤ –æ—Ç–≤–µ—Ç –≤—ã –ø–æ–ª—É—á–∏—Ç–µ 

```json
{
    "rtmp_source": "rtmp://localhost:1935/live/sample1",
    "rtsp_url": "rtsp://localhost:8554/live/sample1",
    "status": "registered"
}
```

–∏ –ø–æ rtsp_url –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω RTSP –ø–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö (–∫–æ—Ç–æ—Ä—ã–π —Å–∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω —Å RTMP)
#### ‚ö†Ô∏è –í–ê–ñ–ù–û!!!

–ü–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ `POST /stream/convert`, **–≤—ã —Å—Ä–∞–∑—É –ø–æ–ª—É—á–∏—Ç–µ RTSP-—Å—Å—ã–ª–∫—É**, –Ω–æ:
> **–ü–æ—Ç–æ–∫—É —Ç—Ä–µ–±—É–µ—Ç—Å—è ~15‚Äì20 —Å–µ–∫—É–Ω–¥ –Ω–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é.**
–ü–µ—Ä–µ–¥ —Ç–µ–º –∫–∞–∫ –æ—Ç–∫—Ä—ã–≤–∞—Ç—å —Å—Å—ã–ª–∫—É –≤ VLC, FFplay –∏–ª–∏ –¥—Ä—É–≥–æ–º RTSP-–∫–ª–∏–µ–Ω—Ç–µ, **–ø–æ–¥–æ–∂–¥–∏—Ç–µ –Ω–µ –º–µ–Ω–µ–µ 15‚Äì20 —Å–µ–∫—É–Ω–¥**, —á—Ç–æ–±—ã MediaMTX —É—Å–ø–µ–ª –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Ç–æ–∫ –∏ –Ω–∞—á–∞—Ç—å —Ä–µ—Ç—Ä–∞–Ω—Å–ª—è—Ü–∏—é.
–ò–Ω–∞—á–µ ‚Äî –∫–ª–∏–µ–Ω—Ç –º–æ–∂–µ—Ç –≤—ã–¥–∞—Ç—å –æ—à–∏–±–∫—É –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è, –ø–æ—Ç–æ–º—É —á—Ç–æ –ø–æ—Ç–æ–∫ –µ—â—ë –Ω–µ –≥–æ—Ç–æ–≤.

–¢–∞–∫–∂–µ –≤ –¥–∞–Ω–Ω–æ–º API –µ—Å—Ç—å –º–Ω–æ–≥–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π, –Ω–∞–ø—Ä–∏–º–µ—Ä:
- http://localhost:8001/streams // –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö —Å—Ç—Ä–∏–º–æ–≤
- http://localhost:8001/streams/{stream_key} // –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± 1 —Å—Ç—Ä–∏–º–µ
- http://localhost:8001/streams/{stream_key}/preview // –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞ —Å—Ç—Ä–∏–º–∞ (–º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–¥ –ø—Ä–µ–≤—å—é)
- http://localhost:8001/health // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã
- http://localhost:8001/logs // –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ª–æ–≥–æ–≤ API

## 5. –ó–∞–ø—É—Å–∫ Dokcer Compose

–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é /mt –∫–æ—Ç–æ—Ä—ã–π –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞
–î–∞–ª–µ–µ —Ç–∞–º –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
docker compose down
```

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –ø–æ–¥–æ–∂–∏—Ç–µ 2-3 —Å–µ–∫—É–Ω–¥—ã (–¥–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —É—Å–ø–µ–ª–∏—Å—å –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è)
–î–∞–ª–µ–µ, –∑–∞–ø—É—Å—Ç–∏—Ç–µ docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä

```bash
docker compose up -d
```

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Node js (–¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Ñ—Ä–æ–Ω—Ç–∞) –∏ —Ç–∞–∫–∂–µ –∑–∞–ø—É—Å–∫ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞

1. –î–ª—è –Ω–∞—á–∞–ª–∞ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ node js
2. –î–∞–ª–µ–µ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é /front:

```bash
cd front
```

3. –î–∞–ª–µ–µ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

```bash
npm install
```

4. –ó–∞–ø—É—Å–∫ React (–§—Ä–æ–Ω—Ç–µ–Ω–¥):

```bash
npm start
```
